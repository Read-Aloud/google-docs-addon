<!DOCTYPE html>
<html>
  <head>
    <title>Read Aloud</title>
    <meta charset="utf-8">
    <base target="_blank">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <?!= include('components-css'); ?>
    <?!= include('sidebar-css'); ?>
  </head>
  
  <body>
    <?!= include('components'); ?>

    <div class="form-group">
      <label>Voice</label>
      <select bind-statement-1="thisElem.disabled = #activeSpeech || #progress"
        bind-event-change="#options.voice = #voices[thisElem.value]">
        <option value="">Auto select</option>
        <option bind-repeater-i="#voices.length"
          bind-statement-1="thisElem.value = #i">{{#voices[#i].name}}</option>
      </select>
    </div>

    <div class="form-group">
      <label>Speed</label>
      <input type="range" min="-1" max="1" step=".05" value="0"
        bind-statement-1="thisElem.disabled = #activeSpeech || #progress"
        bind-event-change="#options.rate = Math.pow(10, thisElem.value)">
    </div>

    <div class="form-group">
      <label>Pitch</label>
      <input type="range" min="0" max="2" step=".05" value="1"
        bind-statement-1="thisElem.disabled = #activeSpeech || #progress"
        bind-event-change="#options.pitch = Number(thisElem.value)">
    </div>

    <div class="form-group buttons" bind-repeater-if="#activeSpeech ? 0 : 1">
      <label>&nbsp;</label>
      <div bind-view="ImageButton"
        bind-param-src="'https://assets.lsdsoftware.com/read-aloud/gdocs-addon/btn-play.png'"
        bind-param-disabled="#progress"
        bind-event-push="this.readAloud()"></div>
    </div>

    <div class="form-group buttons" bind-repeater-if="#activeSpeech ? 1 : 0">
      <label>&nbsp;</label>
      <div bind-repeater-if="#activeSpeech.state == 'PAUSED' ? 1 : 0"
        bind-view="ImageButton"
        bind-param-src="'https://assets.lsdsoftware.com/read-aloud/gdocs-addon/btn-play.png'"
        bind-param-disabled="#progress"
        bind-event-push="activeSpeech.play()"></div>
      <div bind-repeater-if="#activeSpeech.state != 'PAUSED' ? 1 : 0"
        bind-view="ImageButton"
        bind-param-src="'https://assets.lsdsoftware.com/read-aloud/gdocs-addon/btn-pause.png'"
        bind-param-disabled="#progress"
        bind-event-push="activeSpeech.pause()"></div>
      <div bind-view="ImageButton"
        bind-param-src="'https://assets.lsdsoftware.com/read-aloud/gdocs-addon/btn-stop.png'"
        bind-event-push="activeSpeech.stop(); activeSpeech = null"></div>
    </div>

    <div class="form-group status" bind-repeater-if="#error ? 1 : 0">
      <span class="error-message">{{#error.message}}</span>
    </div>

    <div class="footer">
      <a href="https://www.lsdsoftware.com/contact.html?subject=Read%20Aloud%20GDocs%20Addon">report issue</a>
    </div>

    <audio loop src="https://assets.lsdsoftware.com/snd/silence-3s.mp3"
      bind-var-active="!!#activeSpeech"
      bind-statement-1="if (#active) thisElem.play(); else thisElem.pause()"></audio>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://assets.lsdsoftware.com/lib/databind.js"></script>
    <?!= include('utils'); ?>
    <?!= include('components-js'); ?>
    <?!= include('engines'); ?>
    <?!= include('speech'); ?>
    <?!= include('sidebar-js'); ?>
  </body>
</html>
